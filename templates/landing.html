<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>CHATBOT PACARAN - Home</title>

    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Silkscreen:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"/>

    <style>
        :root {
            --bg: #140021;
            --panel: #1f0033;
            --text: #f4f0ff;
            --accent: #a64dff;
            --accent-2: #ff43ff;
            --shadow: rgba(0,0,0,.6);
        }
        * { box-sizing: border-box; }
        html, body { height: 100%; margin: 0; font-family: "Press Start 2P", monospace; color: var(--text); }
        body {
            background-size: cover;
            overflow: hidden;
        }
        .wrap {
            position: relative;
            min-height: 100vh;
            display: grid;
            place-items: center;
            padding: clamp(16px, 3vw, 32px);
        }
        .card {
            width: min(800px, 95vw);
            background: linear-gradient(180deg, rgba(31,0,51,0.95), rgba(37,0,64,0.85));
            border: 4px solid #4a0066;
            box-shadow: 0 20px 40px var(--shadow), inset 0 0 0 4px #0b0f22;
            border-radius: 18px;
            padding: clamp(12px, 2vw, 20px);
            position: relative;
            overflow: hidden;
            text-align: center;
        }
        .title { font-size: clamp(38px,3vw,36px); letter-spacing: 2px; text-shadow:0 3px 0 #210033,0 0 12px rgba(255,77,255,.6); margin: 30px 0 20px; }
        .group-name { font-size: clamp(12px,1.6vw,16px); color:#d3b9ff; opacity:.9; margin-bottom:22px; }
        .catchphrase { font-family:"Silkscreen", monospace; font-size: clamp(16px,1.8vw,20px); color:#fff; text-shadow:0 0 6px rgba(255,255,255,.1),0 0 12px rgba(255,255,255,.6),0 0 20px rgba(255,255,255,.8); margin:12px 0 18px; }
        .characters { margin-top:20px; display:flex; justify-content:center; gap:30px; }
        .char-img { width:130px; image-rendering: pixelated; }
        .cta-row { display:flex; flex-direction: column; align-items:center; gap:16px; margin-top:4px; margin-bottom:20px; }
        .px-btn {
            font-family: "Silkscreen", monospace;
            display: inline-flex; align-items: center; justify-content: center; gap: 10px;
            padding: 18px 24px; font-size: 20px; color: var(--text);
            background: #2b0040; border: 0; cursor: pointer; width: 250px; text-align: center;
            outline: 3px solid var(--accent);
            box-shadow: 0 0 0 4px #0b0f22 inset, 0 10px 0 0 #1a0026, 0 14px 24px rgba(0,0,0,.5);
            transition: transform .02s linear, filter .15s ease;
        }
        .px-btn:hover { filter: brightness(1.15); }
        .px-btn:active { transform: translateY(2px); }
        .px-start { outline-color: var(--accent-2); }
        .px-howto { outline-color: var(--accent); }

        /* ===== CSS untuk Modal Game Info ===== */
        dialog#info-modal {
            border: 4px solid #4a0066;
            border-radius: 18px;
            width: min(720px, 92vw);
            padding: 0;
            background: linear-gradient(180deg, rgba(31,0,51,.95), rgba(37,0,64,.9));
            color: var(--text);
            box-shadow: 0 24px 60px rgba(0,0,0,.6);
        }
        dialog#info-modal::backdrop {
            background: rgba(10, 0, 20, .65);
            backdrop-filter: blur(4px);
        }
        .info-head {
            padding: 16px 18px;
            border-bottom: 2px solid #4a0066;
            font-family: "Silkscreen", monospace;
            display:flex; align-items:center; justify-content:space-between;
        }
        .info-head h2 { margin:0; font-size:20px; }
        .info-close {
            font-family: "Silkscreen", monospace;
            font-size: 18px; font-weight: 700;
            background:#2b0040; color:#fff; border:0; cursor:pointer;
            padding:6px 12px; border-radius:12px; outline:2px solid var(--accent-2);
        }
        .info-tabs {
            display:flex; gap:10px; padding:12px 16px; border-bottom:2px dashed #4a0066; flex-wrap:wrap;
        }
        .info-tab {
            font-family:"Silkscreen", monospace;
            background:#2b0040; color:#fff; border:0; cursor:pointer;
            padding:10px 14px; border-radius:12px; outline:2px solid var(--accent);
        }
        .info-tab.active { outline-color: var(--accent-2); filter: brightness(1.15); }
        .info-body {
            padding:16px 18px 20px; font-size:14px; line-height:1.8;
            max-width: 90%; margin: 0 auto; word-wrap: break-word; white-space: normal;
        }
        .info-panel { display:none; }
        .info-panel.active { display:block; }
        .info-body p { margin:0 0 10px; color:#f4e6ff; }
        #sound-btn {
            position: fixed; top: 20px; right: 20px; font-size: 28px; padding: 14px 16px;
            background: rgba(42, 0, 63, 0.9); color:#fff; border:none; border-radius:12px;
            cursor:pointer; outline:2px solid var(--accent);
            box-shadow:0 0 0 2px #0b0f22 inset, 0 4px 6px rgba(0,0,0,0.5); z-index:9999;
        }
    </style>
</head>
<body class="scanlines" style="background-image: url({{ url_for('static', filename='assets/1134131.png') }});">

    <audio id="bg-music" src="{{ url_for('static', filename='assets/memo.mp3') }}" loop></audio>
    <audio id="click-sound" src="{{ url_for('static', filename='assets/click.mp3') }}"></audio>

    <button id="sound-btn"><i class="fas fa-volume-mute"></i></button>

    <div class="wrap">
        <main class="card">
            <header>
                <h1 class="title">Love in<br>Regex Chat</h1>
                <div class="group-name">Kelompok I</div>
                <div class="catchphrase">"Regex tepat, hubunganmu selamat!"</div>
            </header>
            <div class="characters">
                <img src="{{ url_for('static', filename='assets/couple.png') }}" alt="Pixel couple" class="char-img" />
            </div>
            <div class="cta-row">
                <button class="px-btn px-start">START CHAT</button>
                <button class="px-btn px-howto" id="btn-info">GAME INFO</button>
            </div>
        </main>
    </div>

    <dialog id="info-modal" aria-labelledby="info-title">
        <div class="info-head">
            <div style="display:flex;align-items:center;gap:8px;">
                <img src="{{ url_for('static', filename='assets/light.png') }}"
                     alt="Lampu"
                     style="width:50px;height:auto;image-rendering:pixelated;filter: drop-shadow(0 0 6px rgba(255,255,150,.8));">
                <h2 id="info-title">GAME INFO</h2>
            </div>
            <button class="info-close" id="info-close">X</button>
        </div>
        <div class="info-tabs">
            <button class="info-tab active" data-tab="about">ABOUT US</button>
            <button class="info-tab" data-tab="intro">PENGENALAN GAME</button>
            <button class="info-tab" data-tab="nlp">TUGAS NLP</button>
        </div>
        <div class="info-body">
            <div class="info-panel active" id="panel-about">
                <p><strong>About Us</strong> ‚Äî Group Regex I adalah tim kreatif yang membuat proyek ini untuk melatih kepekaan dan kemampuan membaca pola Regex dalam percakapan interaktif üíª‚ù§</p>
                <p>
                    <strong>Anggota tim:</strong><br>
                    Muhammad Rajif Al Farikhi (162112133008)<br>
                    Ellen Diva Ibanez (164231014)<br>
                    Manisa (164231050)<br>
                    Indrayana Widhikartiko (164231079)<br>
                    Mohammad Faizal Aprilianto (164231095)<br>
                    Sarah Alya Azizah (164231105)
                </p>
            </div>
            <div class="info-panel" id="panel-intro">
                <p><strong>Pengenalan Game</strong> ‚Äî Di Love in Regex Chat, kamu harus bertahan lima hari berkomunikasi dengan pasangan unik yang hanya membalas pesan pakai Regex. Tebak jawaban yang benar agar percakapan terus berjalan dan jangan sampai nyawamu habis. Game ini melatih kepekaan terhadap konteks percakapan sekaligus kemampuan membaca pola Regex.</p>
            </div>
            <div class="info-panel" id="panel-nlp">
                <p><strong>Tugas NLP</strong> ‚Äî Proyek ini merupakan Tugas 1 mata kuliah Natural Language Processing yang membahas topik Regex dan N-Gram, dibimbing oleh Dr. Maryamah, S.Kom. Kelompok kami mendapatkan fokus pada Regex. Untuk membuat tugas ini lebih menarik, kami mengemas pola Regex ini dalam game berbasis chat ala pasangan, sehingga pemain dapat menebak dan men-decode pola Regex secara seru namun tetap edukatif.</p>
            </div>
        </div>
    </dialog>

    <script>
        // === Variabel Elemen ===
        const bgMusic = document.getElementById('bg-music');
        const clickSound = document.getElementById('click-sound');
        const startBtn = document.querySelector('.px-start');
        const howtoBtn = document.querySelector('.px-howto');
        const soundBtn = document.getElementById('sound-btn');
        const infoModal = document.getElementById('info-modal');
        const infoClose = document.getElementById('info-close');
        const tabButtons = infoModal.querySelectorAll('.info-tab');
        const panels = {
          about: document.getElementById('panel-about'),
          intro: document.getElementById('panel-intro'),
          nlp:   document.getElementById('panel-nlp')
        };
        let isPlaying;

        // === Fungsi Suara ===
        function playClickSound() {
            if (clickSound) {
                clickSound.currentTime = 0;
                clickSound.volume = 1;
                clickSound.play();
            }
        }
        function updateSoundButton() {
            if (soundBtn) {
                soundBtn.innerHTML = isPlaying ? '<i class="fas fa-volume-up"></i>' : '<i class="fas fa-volume-mute"></i>';
            }
        }

        // === Logika Utama (Musik, Navigasi, Modal) ===
        document.addEventListener('DOMContentLoaded', () => {
            const musicState = localStorage.getItem('musicIsPlaying');
            const savedTime = localStorage.getItem('musicCurrentTime');
            if (savedTime) {
                bgMusic.currentTime = parseFloat(savedTime);
            }
            if (musicState === 'false') {
                isPlaying = false;
            } else {
                isPlaying = true;
                bgMusic.volume = 0.4;
                bgMusic.play().catch(e => {
                    isPlaying = false;
                    updateSoundButton();
                });
            }
            updateSoundButton();
        });
        
        if (soundBtn) {
            soundBtn.addEventListener('click', () => {
                playClickSound();
                isPlaying = !isPlaying;
                if (isPlaying) {
                    bgMusic.play();
                } else {
                    bgMusic.pause();
                }
                localStorage.setItem('musicIsPlaying', isPlaying);
                updateSoundButton();
            });
        }
        
        window.addEventListener('beforeunload', () => {
            localStorage.setItem('musicCurrentTime', bgMusic.currentTime);
            localStorage.setItem('musicIsPlaying', isPlaying);
        });

        // Navigasi Tombol START CHAT
        startBtn.addEventListener('click', () => {
         playClickSound();
         window.location.href = "{{ url_for('rules') }}";
        });
        
        // Logika untuk Modal
        howtoBtn.addEventListener('click', () => {
            playClickSound();
            infoModal.showModal();
        });
        infoClose.addEventListener('click', () => {
            playClickSound();
            infoModal.close();
        });
        infoModal.addEventListener('click', (e) => {
            if (e.target === infoModal) {
                playClickSound();
                infoModal.close();
            }
        });

        // Logika untuk Tab di dalam Modal
        tabButtons.forEach(btn => {
         btn.addEventListener('click', () => {
             playClickSound();
             tabButtons.forEach(b => b.classList.remove('active'));
             btn.classList.add('active');
             Object.values(panels).forEach(p => p.classList.remove('active'));
             panels[btn.dataset.tab].classList.add('active');
         });
        });
    </script>
</body>
</html>